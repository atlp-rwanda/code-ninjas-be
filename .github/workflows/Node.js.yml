name: CI

on:
  push:
    branches: [ch-setup-test-181414701]
  pull_request:
    branches: [ch-setup-test-181414701]

    # Allows you to run this workflow manually from the Actions tabb
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
      - run: yarn install
      - run: yarn run build
      - run: yarn test
      - name: Code Climate Test Reporter
        uses: aktions/codeclimate-test-reporter@v1
        with:
          codeclimate-test-reporter-id: d1a7faa48cd92b07f5561dce5e948e3e0c49ffb4f4c469bd1a3b12b5ee4a96ff
          command: after-build
    env:
      CI: true
      DB_CONNECT: ${{ secrets.DB_CONNECT }}
      DEV_DB: ${{ secrets.DEV_DB }}
      TEST_DB: ${{ secrets.TEST_DB }}
